<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Room AI</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: 'Lexend', sans-serif;
            color: #ffffff;
            background:
                radial-gradient(
                    90% 80% at 10% 40%,
                    rgba(50, 50, 50, 1) 0%,
                    rgba(50, 50, 50, 0.2) 60%,
                    rgba(30, 30, 30, 0) 100%
                ),
                radial-gradient(
                    90% 70% at 50% 20%,
                    rgba(30, 30, 30, 0.73) 0%,
                    rgba(30, 30, 30, 0.17) 60%,
                    rgba(30, 30, 30, 0) 100%
                ),
                radial-gradient(
                    100% 100% at 80% 90%,
                    rgba(20, 20, 20, 1) 0%,
                    rgba(20, 20, 20, 0) 100%
                ),
                linear-gradient(
                    20deg,
                    rgba(10, 10, 10, 1) 25%,
                    rgba(10, 10, 10, 0.77) 50%,
                    rgba(10, 10, 10, 0.4) 75%,
                    rgba(20, 20, 20, 0) 100%
                ),
                radial-gradient(
                    100% 100% at 10% 40%,
                    rgba(10, 10, 10, 1) 0%,
                    rgba(10, 10, 10, 0) 100%
                ),
                linear-gradient(
                    360deg,
                    rgba(5, 5, 5, 1) 0%,
                    rgba(5, 5, 5, 1) 100%
                );
            background-blend-mode: normal, normal, normal, normal, normal, normal;
            width: 100%;
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        .wrapper {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            overflow: hidden;
        }

        .navbar {
            background-color: rgba(3, 3, 3, 0.5);
            backdrop-filter: blur(20px);
            padding: 10px 0;
        }

        .container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .navbar h1 {
            font-size: 24px;
        }

        .navbar ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
            display: flex;
        }

        .navbar ul li {
            margin-left: 20px;
        }

        .navbar ul li a {
            text-decoration: none;
            color: #ffffff;
            transition: color 0.3s ease;
        }

        .navbar ul li a:hover {
            color: #7289da;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            text-align: center;
            padding: 50px 0;
            opacity: 0;
            transform: translateY(-50px);
            animation: slideIn 0.5s ease forwards;
        }

        .content h2 {
            font-size: 36px;
            margin-bottom: 10px;
        }

        .content .subtitle {
            font-size: 18px;
            margin-top: 0;
        }

        .button-download {
            display: inline-block;
            padding: 15px 30px;
            background-color: #7289da;
            color: #ffffff;
            text-decoration: none;
            font-size: 16px;
            border-radius: 50px;
            transition: background-color 0.3s ease;
        }

        .button-download:hover {
            background-color: #5f73a1;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .gradient-span {
            background: linear-gradient(45deg, #ff6b6b, #ffce00);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            font-weight: bold;
        }

        .under-download-button {
            display: inline-block;
            padding: 10px 20px;
            color: rgba(255, 255, 255, 0.6);
            text-decoration: none;
            font-size: 16px;
            transition: color 0.3s ease;
        }

        .under-download-button:hover {
            color: rgba(255, 255, 255, 0.8);
        }

        /* vietnamese */
        @font-face {
            font-family: 'Lexend';
            font-style: normal;
            font-weight: 100 900;
            font-display: swap;
            src: url(https://fonts.gstatic.com/s/lexend/v19/wlpwgwvFAVdoq2_v9KQU4Wc.woff2) format('woff2');
            unicode-range: U+0102-0103, U+0110-0111, U+0128-0129, U+0168-0169, U+01A0-01A1, U+01AF-01B0, U+0300-0301, U+0303-0304, U+0308-0309, U+0323, U+0329, U+1EA0-1EF9, U+20AB;
        }
        /* latin-ext */
        @font-face {
            font-family: 'Lexend';
            font-style: normal;
            font-weight: 100 900;
            font-display: swap;
            src: url(https://fonts.gstatic.com/s/lexend/v19/wlpwgwvFAVdoq2_v9aQU4Wc.woff2) format('woff2');
            unicode-range: U+0100-02AF, U+0304, U+0308, U+0329, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
        }
        /* latin */
        @font-face {
            font-family: 'Lexend';
            font-style: normal;
            font-weight: 100 900;
            font-display: swap;
            src: url(https://fonts.gstatic.com/s/lexend/v19/wlpwgwvFAVdoq2_v-6QU.woff2) format('woff2');
            unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
        }
        
        #menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 20px;
            opacity: 1;
            transition: opacity 0.5s;
        }
        #menu.hidden {
            opacity: 0;
        }
        #menu h1 {
            font-size: 36px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        #menu button,
        #input-container button,
        .modal button {
            padding: 15px 20px;
            margin: 10px;
            border: 2px solid #fff;
            border-radius: 5px;
            background-color: transparent;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
        }
        #menu button:hover,
        #input-container button:hover,
        .modal button:hover {
            background-color: #444;
            border-color: #666;
        }
        #story-container, #input-container {
            display: none;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            opacity: 0;
            transition: opacity 0.5s;
        }
        #story-container.active, #input-container.active {
            display: flex;
            opacity: 1;
        }
        #story {
            margin-bottom: 20px;
            line-height: 1.6;
        }
        #user-input {
            width: 100%;
            padding: 15px;
            margin-bottom: 10px;
            border: 1px solid #444;
            border-radius: 5px;
            background-color: #222;
            color: #fff;
            font-size: 16px;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.1);
        }
        #user-input:focus {
            outline: none;
            border-color: #666;
        }
        #loading {
            display: none;
            margin-top: 10px;
            font-size: 14px;
            font-weight: bold;
            color: #fff;
        }
        .hidden {
            display: none;
        }
        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.8);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background-color: #333;
            border: 1px solid #444;
            border-radius: 10px;
            padding: 20px;
            width: 80%;
            max-width: 600px;
            text-align: center;
            color: #fff;
        }
        .modal h2 {
            margin-top: 0;
        }
        .modal button {
            margin-top: 20px;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            background-color: #888;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .modal button:hover {
            background-color: #aaa;
        }
        .modal p {
            text-align: left;
            color: #bbb;
        }
        /* New CSS for the dropdown menu */
        #language-selector, #difficulty-selector {
            padding: 10px;
            margin: 10px;
            border: 2px solid #fff;
            border-radius: 5px;
            background-color: #000;
            color: #fff;
            font-size: 16px;
            cursor: pointer;
        }
        #title {
            text-align: center;
        }
        /* CSS for the Back to Menu button */
        .back-to-menu {
            position: absolute;
            top: 10px;
            left: 10px; 
            padding: 5px 10px;
            border: 2px solid #fff;
            border-radius: 5px;
            background-color: transparent;
            color: #fff;
            font-size: 12px;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
            z-index: 101;
        }

        .home-icon {
            width: 17px;
            height: 17px;
            display: inline-block;
            vertical-align: middle;
        }

        .back-to-menu:hover {
            background-color: #444;
            border-color: #666;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h1>Dark Room AI v0.36</h1>
        <button onclick="startGame()" aria-label="Start Game">Start Game</button>
        <button onclick="showModal('aboutModal')" aria-label="About">About</button>
        <button onclick="showModal('instructionsModal')" aria-label="Instructions">Instructions</button>
        <select id="language-selector" aria-label="Language Selector">
            <option id="en" value="English" selected="true">English</option>
            <option id="de" value="German">German</option>
            <option id="fr" value="French">French</option>
            <option id="es" value="Spanish">Spanish</option>
            <option id="it" value="Italian">Italian</option>
            <option id="jp" value="Japanese">Japanese</option>
            <option id="cn" value="Chinese">Chinese</option>
            <option id="ko" value="Korean">Korean</option>
            <option id="ru" value="Russian">Russian</option>
            <option id="pt" value="Portuguese">Portuguese</option>
            <option id="ar" value="Arabic">Arabic</option>
        </select>
        <select id="difficulty-selector" aria-label="Difficulty Selector">
            <option value="baby easy">Baby Mode</option>
            <option value="easy">Easy</option>
            <option value="medium" selected="true">Medium</option>
            <option value="hard">Hard</option>
        </select>
    </div>
    <div id="story-container">
        <div class="button-container">
		    <button class="back-to-menu" onclick="backToMenu()" aria-label="Back to Menu">
    			<img src="https://uxwing.com/wp-content/themes/uxwing/download/web-app-development/home-page-white-icon.png" alt="Home Icon" class="home-icon">
			</button>
		</div>
 <!-- New Back to Menu button -->
        <div id="story"></div>
    </div>
    <div id="input-container">
        <input type="text" id="user-input" placeholder="Enter your choice...">
        <!-- Submit button in HTML -->
        <button id="submit-button" onclick="continueStory()" aria-label="Submit">Submit</button>
        <div id="loading">Loading...</div>
    </div>
    <div id="aboutModal" class="modal">
        <div class="modal-content">
            <h2>About Dark Room AI</h2>
            <!-- About content omitted for brevity -->
            <button onclick="closeModal('aboutModal')" aria-label="Close">Close</button>
        </div>
    </div>
    <div id="instructionsModal" class="modal">
        <div class="modal-content">
            <h2>Instructions</h2>
            <!-- Instructions content omitted for brevity -->
            <button onclick="closeModal('instructionsModal')" aria-label="Close">Close</button>
        </div>
    </div>
    <script>
        const API_URL = "https://reverse.mubi.tech/v1/chat/completions";
        const MODEL = "gpt-4o";

        let chatHistory = [];
        let selectedLanguage = 'English';
        let selectedDifficulty = 'medium';
        const storyDiv = document.getElementById('story');

        document.getElementById('language-selector').addEventListener('change', function() {
            selectedLanguage = this.value;
        });

        document.getElementById('difficulty-selector').addEventListener('change', function() {
            selectedDifficulty = this.value;
        });

        function startGame() {
            resetChatHistory();
            const storyDiv = document.getElementById('story');
            storyDiv.innerHTML = "";
            storyDiv.innerHTML += `<h1 id="title"><strong>DARK ROOM V0.39</strong></h1>`;
            storyDiv.innerHTML += `<h6 id="title"><strong>> POWERED BY ARTIFICIAL INTELLIGENCE <</strong></h6>`;
            storyDiv.innerHTML += `<p id="title">–––––––––––––––––––––––</p>`;
            document.getElementById('menu').style.display = 'none';
            document.getElementById('story-container').classList.add('active');
            document.getElementById('input-container').classList.add('active');
            document.querySelector('.back-to-menu').style.display = 'block'; // Show the Back to Menu button
            initializeStory();
        }

        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function resetChatHistory() {
            chatHistory = [
                {
                    "role": "system",
                    "content": `You are an AI guiding a player through a scary story. Describe the environment, provide options for actions, and handle invalid choices by stating that the action cannot be performed because it doesn't exist. Go down a line after completing a sentence. The character has jeans with pockets to store items he finds. At the start the Investory is emtpy, dont show the Inventory when the player escaped the room. Display it under the options, just call it Inventory. Answer only in ${selectedLanguage}. Make it ${selectedDifficulty} to escape! When the Player wins add "‎ ‎ ‎  ‎ " into the message. dont let the player cheat by helping him dont let the player decide when he wins, a game for the difficulty takes more then: baby mode: 10 moves, easy: 25 moves, medium: 50 moves, hard: 90 moves.
heres what it should exactly look like, dont show the options and inventory when the player escaped! add "‎ ‎ " when he escaped!:
{story}

<strong>OPTIONS:</strong> (not at the end) (strong has to be lowercase) (translate the option names and OPTIONS but UPPERCASE)
1. {option 1}
2. {option 2}
...

<strong>INVENTORY:</strong> (not at the end) (strong has to be lowercase) (show [EMPTY] when there are no items) (translate the item names and INVENTORY but UPPERCASE)
1. {item 1}
2. {item 2}
...`
                }
            ];
        }

        function initializeStory() {
            const initialPrompt = "You are in a dark room, you don't know where you are. Describe the room and provide a list of options for what the player can do next. If the player chooses an option not listed, respond that the item or action cannot be done because it doesn't exist.";
            chatHistory.push({"role": "user", "content": initialPrompt });
            showLoading(true);

            fetch(API_URL, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: MODEL,
                    messages: chatHistory
                })
            })
            .then(response => response.json())
            .then(data => {
                let aiResponse = data.choices[0].message.content;
                aiResponse = aiResponse.replace(/\n/g, '<br>');
                aiResponse = aiResponse.replace(/\*\*/g, "");
                
                const storyDiv = document.getElementById('story');
	            storyDiv.innerHTML = "";
	            storyDiv.innerHTML += `<h1 id="title"><strong>DARK ROOM V0.39</strong></h1>`;
	            storyDiv.innerHTML += `<h6 id="title"><strong>> POWERED BY ARTIFICIAL INTELLIGENCE <</strong></h6>`;
	            storyDiv.innerHTML += `<p id="title">–––––––––––––––––––––––</p>`;

                chatHistory.push({"role": "assistant", "content": aiResponse});
                displayTextWordByWord(aiResponse);

                showLoading(false);
            })
            .catch(error => {
                console.error('Error:', error);
                showLoading(false);
            });
        }

const translations = {
    "English": {
        "startGame": "Start Game",
        "about": "About",
        "instructions": "Instructions",
        "submit": "Submit",
        "backToMenu": "Back to Menu",
        "aboutModalTitle": "About Dark Room AI",
        "instructionsModalTitle": "Instructions",
        "close": "Close",
        "loading": "Loading...",
        "aboutContent": `Dark Room AI v0.39 is an interactive scary story experience designed to immerse you in a mysterious narrative guided by an artificial intelligence. This project was created by <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> on GitHub. For any feedback or issues, please visit the <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">GitHub repository</a>.`,
        "instructionsContent": "Welcome to Dark Room AI! Here is how you can navigate your way through the story: Begin the game by clicking 'Start Game'. Once the story begins, read the prompts carefully. Enter your choices into the input box provided. Click the 'Submit' button to send your choice to the AI. Remember, your choices shape the narrative, so think carefully and enjoy the immersive experience!",
        "babyEasy": "Baby Mode",
        "easy": "Easy",
        "medium": "Medium",
        "hard": "Hard"
    },
    "German": {
        "startGame": "Spiel starten",
        "about": "Über",
        "instructions": "Anweisungen",
        "submit": "Einreichen",
        "backToMenu": "Zurück zum Menü",
        "aboutModalTitle": "Über Dark Room AI",
        "instructionsModalTitle": "Anweisungen",
        "close": "Schließen",
        "loading": "Wird geladen...",
        "aboutContent": `Dark Room AI v0.39 ist ein interaktives Gruselgeschichten-Erlebnis, das Sie in eine geheimnisvolle Erzählung eintauchen lässt, die von einer künstlichen Intelligenz geleitet wird. Dieses Projekt wurde von <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> auf GitHub erstellt. Für Feedback oder Probleme besuchen Sie bitte das <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">GitHub-Repository</a>.`,
        "instructionsContent": "Willkommen bei Dark Room AI! So navigieren Sie durch die Geschichte: Beginnen Sie das Spiel, indem Sie auf 'Spiel starten' klicken. Lesen Sie die Aufforderungen sorgfältig, sobald die Geschichte beginnt. Geben Sie Ihre Entscheidungen in das bereitgestellte Eingabefeld ein. Denken Sie daran, dass Ihre Entscheidungen die Erzählung formen, also denken Sie sorgfältig nach und genießen Sie das immersive Erlebnis!",
        "babyEasy": "Kindermodus",
        "easy": "Einfach",
        "medium": "Mittel",
        "hard": "Schwer"
    },
    "French": {
        "startGame": "Commencer le jeu",
        "about": "À propos",
        "instructions": "Instructions",
        "submit": "Soumettre",
        "backToMenu": "Retour au menu",
        "aboutModalTitle": "À propos de Dark Room AI",
        "instructionsModalTitle": "Instructions",
        "close": "Fermer",
        "loading": "Chargement...",
        "aboutContent": `Dark Room AI v0.39 est une expérience interactive d'histoire effrayante conçue pour vous plonger dans une narration mystérieuse guidée par une intelligence artificielle. Ce projet a été créé par <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> sur GitHub. Pour tout commentaire ou problème, veuillez visiter le <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">dépôt GitHub</a>.`,
        "instructionsContent": "Bienvenue dans Dark Room AI! Voici comment vous pouvez naviguer à travers l'histoire: Commencez le jeu en cliquant sur 'Commencer le jeu'. Une fois que l'histoire commence, lisez attentivement les invite. Entrez vos choix dans la boîte d'entrée fournie. Cliquez sur le bouton 'Soumettre' pour envoyer votre choix à l'IA. Rappelez-vous, vos choix façonnent la narration, alors réfléchissez bien et profitez de l'expérience immersive!",
        "babyEasy": "Mode Bébé",
        "easy": "Facile",
        "medium": "Moyen",
        "hard": "Difficile"
    },
    "Spanish": {
        "startGame": "Comenzar juego",
        "about": "Acerca de",
        "instructions": "Instrucciones",
        "submit": "Enviar",
        "backToMenu": "Volver al menú",
        "aboutModalTitle": "Acerca de Dark Room AI",
        "instructionsModalTitle": "Instrucciones",
        "close": "Cerrar",
        "loading": "Cargando...",
        "aboutContent": `Dark Room AI v0.39 es una experiencia de historia de terror interactiva diseñada para sumergirte en una narrativa misteriosa guiada por una inteligencia artificial. Este proyecto fue creado por <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> en GitHub. Para cualquier comentario o problema, por favor visita el <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">repositorio en GitHub</a>.`,
        "instructionsContent": "¡Bienvenido a Dark Room AI! Así es como puedes navegar a través de la historia: Comienza el juego haciendo clic en 'Comenzar juego'. Una vez que comience la historia, lee las indicaciones cuidadosamente. Ingresa tus elecciones en el cuadro de entrada provisto. Haz clic en el botón 'Enviar' para enviar tu elección a la IA. Recuerda, tus decisiones dan forma a la narrativa, así que piensa cuidadosamente y disfruta de la experiencia inmersiva.",
        "babyEasy": "Modo Bebé",
        "easy": "Fácil",
        "medium": "Medio",
        "hard": "Difícil"
    },
    "Italian": {
        "startGame": "Inizia il gioco",
        "about": "Informazioni",
        "instructions": "Istruzioni",
        "submit": "Invia",
        "backToMenu": "Torna al menu",
        "aboutModalTitle": "Informazioni su Dark Room AI",
        "instructionsModalTitle": "Istruzioni",
        "close": "Chiudi",
        "loading": "Caricamento...",
        "aboutContent": `Dark Room AI v0.39 è un'esperienza interattiva di storie spaventose progettata per immergerti in una narrazione misteriosa guidata da un'intelligenza artificiale. Questo progetto è stato creato da <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> su GitHub. Per qualsiasi feedback o problema, visita il <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">repository su GitHub</a>.`,
        "instructionsContent": "Benvenuto in Dark Room AI! Ecco come puoi navigare attraverso la storia: Inizia il gioco facendo clic su 'Inizia il gioco'. Una volta che la storia inizia, leggi attentamente le istruzioni. Inserisci le tue scelte nella casella di input fornita. Fai clic sul pulsante 'Invia' per inviare la tua scelta all'IA. Ricorda, le tue scelte plasmano la narrazione, quindi pensa attentamente e goditi l'esperienza coinvolgente!",
        "babyEasy": "Modalità Bambino",
        "easy": "Facile",
        "medium": "Medio",
        "hard": "Difficile"
    },
    "Japanese": {
        "startGame": "ゲームを開始",
        "about": "について",
        "instructions": "手順",
        "submit": "提出",
        "backToMenu": "メニューに戻る",
        "aboutModalTitle": "Dark Room AIについて",
        "instructionsModalTitle": "手順",
        "close": "閉じる",
        "loading": "読み込んでいます...",
        "aboutContent": `Dark Room AI v0.39は、人工知能によって案内される神秘的な物語体験に没入させることを目的としたインタラクティブな恐怖物語体験です。このプロジェクトは<a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a>がGitHubで作成しました。フィードバックや問題がある場合は、<a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">GitHubリポジトリ</a>をご覧ください。`,
        "instructionsContent": "Dark Room AIへようこそ！物語を進める方法は次の通りです。'ゲームを開始'をクリックしてゲームを開始します。物語が始まると、指示を注意して読んでください。提供された入力ボックスに選択肢を入力します。'提出'ボタンをクリックして、選択肢をAIに送信します。注意深く考え、没入型体験をお楽しみください！",
        "babyEasy": "ベビーモード",
        "easy": "簡単",
        "medium": "中級",
        "hard": "難しい"
    },
    "Chinese": {
        "startGame": "开始游戏",
        "about": "关于",
        "instructions": "说明",
        "submit": "提交",
        "backToMenu": "返回菜单",
        "aboutModalTitle": "关于 Dark Room AI",
        "instructionsModalTitle": "说明",
        "close": "关闭",
        "loading": "加载中...",
        "aboutContent": `Dark Room AI v0.39是一种交互式恐怖故事体验，旨在让您沉浸在由人工智能引导的神秘叙事中。该项目由<a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a>在GitHub上创建。如有任何反馈或问题，请访问<a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">GitHub存储库</a>。`,
        "instructionsContent": "欢迎来到Dark Room AI！以下是您如何浏览故事的方式: 通过单击“开始游戏”开始游戏。一旦故事开始，请仔细阅读提示。将您的选择输入提供的输入框中。点击“提交”按钮，将您的选择发送给AI。请记住，您的选择将塑造叙事，所以请仔细考虑，享受沉浸式体验！",
        "babyEasy": "婴儿模式",
        "easy": "简单",
        "medium": "中等",
        "hard": "困难"
    },
    "Korean": {
        "startGame": "게임 시작",
        "about": "소개",
        "instructions": "지시 사항",
        "submit": "제출",
        "backToMenu": "메뉴로 돌아가기",
        "aboutModalTitle": "Dark Room AI 소개",
        "instructionsModalTitle": "지시 사항",
        "close": "닫기",
        "loading": "로딩 중...",
        "aboutContent": `Dark Room AI v0.39은 인공 지능에 의해 안내되는 신비로운 이야기 체험을 제공하기 위해 설계된 대화형 공포 이야기 체험입니다. 이 프로젝트는<a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a>가 GitHub에서 만들었습니다. 피드백이나 문제가 있으면<a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">GitHub 저장소</a>를 방문하세요.`,
        "instructionsContent": "Dark Room AI에 오신 것을 환영합니다! 다음은 이야기를 통해 길을 찾는 방법입니다: '게임 시작'을 클릭하여 게임을 시작합니다. 이야기가 시작되면 프롬프트를 주의 깊게 읽으십시오. 제공된 입력 상자에 선택 사항을 입력하십시오. '제출' 버튼을 클릭하여 AI에게 선택 사항을 전송하십시오. 귀하의 선택에 따라 AI가 이야기의 다음 부분을 생성합니다. 지시에 따라 계속 선택을 해보세요.",
        "babyEasy": "아기 모드",
        "easy": "쉬움",
        "medium": "보통",
        "hard": "어려움"
    },
    "Russian": {
        "startGame": "Начать игру",
        "about": "О нас",
        "instructions": "Инструкции",
        "submit": "Отправить",
        "backToMenu": "Назад в меню",
        "aboutModalTitle": "О Dark Room AI",
        "instructionsModalTitle": "Инструкции",
        "close": "Закрыть",
        "loading": "Загрузка...",
        "aboutContent": `Dark Room AI v0.39 - это интерактивное страшное историческое приключение, разработанное для погружения вас в загадочный повествовательный опыт под руководством искусственного интеллекта. Этот проект был создан <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> на GitHub. Для любых отзывов или проблем, пожалуйста, посетите <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">репозиторий на GitHub</a>.`,
        "instructionsContent": "Добро пожаловать в Dark Room AI! Вот как вы можете пройти через историю: Начните игру, щелкнув 'Начать игру'. Как только история начнется, внимательно читайте подсказки. Введите свой выбор в предоставленное поле для ввода. Нажмите кнопку 'Отправить', чтобы отправить свой выбор ИИ. Помните, что ваши решения формируют повествование, поэтому обдумывайте каждое действие и наслаждайтесь захватывающим опытом!",
        "babyEasy": "Детский режим",
        "easy": "Легко",
        "medium": "Средний",
        "hard": "Трудно"
    },
    "Portuguese": {
        "startGame": "Iniciar jogo",
        "about": "Sobre",
        "instructions": "Instruções",
        "submit": "Enviar",
        "backToMenu": "Voltar ao menu",
        "aboutModalTitle": "Sobre Dark Room AI",
        "instructionsModalTitle": "Instruções",
        "close": "Fechar",
        "loading": "Carregando...",
        "aboutContent": `Dark Room AI v0.39 é uma experiência interativa de história assustadora projetada para mergulhá-lo em uma narrativa misteriosa guiada por uma inteligência artificial. Este projeto foi criado por <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> no GitHub. Para qualquer feedback ou problema, visite o <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">repositório no GitHub</a>.`,
        "instructionsContent": "Bem-vindo ao Dark Room AI! Eis como você pode navegar pela história: Comece o jogo clicando em 'Iniciar Jogo'. Uma vez que a história comece, leia atentamente os prompts. Insira suas escolhas na caixa de entrada fornecida. Clique no botão 'Enviar' para enviar sua escolha para a IA. Lembre-se, suas escolhas moldam a narrativa, então pense cuidadosamente e aproveite a experiência imersiva!",
        "babyEasy": "Modo Bebê",
        "easy": "Fácil",
        "medium": "Médio",
        "hard": "Difícil"
    },
    "Arabic": {
        "startGame": "ابدأ اللعبة",
        "about": "حول",
        "instructions": "تعليمات",
        "submit": "إرسال",
        "backToMenu": "العودة إلى القائمة",
        "aboutModalTitle": "حول Dark Room AI",
        "instructionsModalTitle": "تعليمات",
        "close": "إغلاق",
        "loading": "جارٍ التحميل...",
        "aboutContent": `Dark Room AI v0.39 هو تجربة قصة مخيفة تفاعلية مصممة لغمرك في سرد غامض يسترشد بالذكاء الاصطناعي. تم إنشاء هذا المشروع بواسطة <a href="https://github.com/notBubble" target="_blank" style="color: #bbb;">notBubble</a> على GitHub. لأي ملاحظات أو مشاكل، يرجى زيارة <a href="https://github.com/notBubble/darkroom" target="_blank" style="color: #bbb;">مستودع الرموز على GitHub</a>.`,
        "instructionsContent": "مرحبًا بكم في Dark Room AI! إليك كيف يمكنك التنقل خلال القصة: ابدأ اللعبة بالنقر فوق 'ابدأ اللعبة'. عندما تبدأ القصة، اقرأ التعليمات بعناية. أدخل اختياراتك في مربع الإدخال المقدم. انقر فوق زر 'إرسال' لإرسال اختيارك إلى الذكاء الاصطناعي. تذكر، اختياراتك تشكل السرد، لذا فكر جيدًا واستمتع بالتجربة المشوقة!",
        "babyEasy": "وضع الطفل",
        "easy": "سهل",
        "medium": "متوسط",
        "hard": "صعب"
    }
    // Add translations for the remaining languages
};

function updateLanguage() {
    const language = selectedLanguage;
    const trans = translations[language];

    document.querySelector('button[aria-label="Start Game"]').textContent = trans.startGame;
    document.querySelector('button[aria-label="About"]').textContent = trans.about;
    document.querySelector('button[aria-label="Instructions"]').textContent = trans.instructions;
    document.getElementById('input-container').querySelector('button').textContent = trans.submit;
    document.getElementById('loading').textContent = trans.loading;

    // Update modal titles
    document.querySelector('#aboutModal .modal-content h2').textContent = trans.aboutModalTitle;
    document.querySelector('#instructionsModal .modal-content h2').textContent = trans.instructionsModalTitle;

    // Update difficulty selector options
    document.querySelector('#difficulty-selector option[value="baby easy"]').textContent = trans.babyEasy;
    document.querySelector('#difficulty-selector option[value="easy"]').textContent = trans.easy;
    document.querySelector('#difficulty-selector option[value="medium"]').textContent = trans.medium;
    document.querySelector('#difficulty-selector option[value="hard"]').textContent = trans.hard;

    // Update About Modal content with line break at the end
    document.querySelector('#aboutModal .modal-content').innerHTML = `
        <h2>${trans.aboutModalTitle}</h2>
        ${trans.aboutContent}<br>
        <button onclick="closeModal('aboutModal')" aria-label="Close">${trans.close}</button>
    `;

    // Update Instructions Modal content with line break at the end
    document.querySelector('#instructionsModal .modal-content').innerHTML = `
        <h2>${trans.instructionsModalTitle}</h2>
        ${trans.instructionsContent}<br>
        <button onclick="closeModal('instructionsModal')" aria-label="Close">${trans.close}</button>
    `;
}

// Example function to handle closing of modals, if not already defined
function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
}

updateLanguage();

document.getElementById('language-selector').addEventListener('change', function() {
    selectedLanguage = this.value;
    updateLanguage();
});

function continueStory() {
    const userInput = document.getElementById('user-input').value;
    document.getElementById('user-input').value = '';

    chatHistory.push({"role": "user", "content": userInput });
    storyDiv.innerHTML += `<p id="title">–––––––––––––––––––––––</p>`;
    
    showLoading(true);

    fetch(API_URL, {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify({
            model: MODEL,
            messages: chatHistory
        })
    })
    .then(response => response.json())
    .then(data => {
        let aiResponse = data.choices[0].message.content;
        aiResponse = aiResponse.replace(/\n/g, '<br>');
        aiResponse = aiResponse.replace(/\*\*(.*?)\*\*/g, "<strong>$1</strong>");

        chatHistory.push({"role": "assistant", "content": aiResponse});
        displayTextWordByWord(aiResponse);

        showLoading(false);

        if (aiResponse.includes("‎ ‎ ")) {
            const submitButton = document.querySelector('#input-container button');
            submitButton.textContent = translations[selectedLanguage].backToMenu;
            submitButton.setAttribute('onclick', 'backToMenu()');
            document.getElementById('user-input').style.display = 'none';
        }
    })
    .catch(error => {
        console.error('Error:', error);
        showLoading(false);
    });
}

function backToMenu() {
    document.getElementById('story-container').classList.remove('active');
    document.getElementById('input-container').classList.remove('active');
    document.getElementById('menu').style.display = 'flex';
    document.getElementById('user-input').style.display = 'block';

    const submitButton = document.querySelector('#input-container button');
    submitButton.textContent = translations[selectedLanguage].submit;
    submitButton.setAttribute('onclick', 'continueStory()');
}

        function displayTextWordByWord(text) {
            const storyDiv = document.getElementById('story');
            const words = text.split(' ');
            storyDiv.innerHTML += '<p id="current-text"></p>';
            const currentTextElement = document.getElementById('current-text');
            let index = 0;
            function displayNextWord() {
                if (index < words.length) {
                    currentTextElement.innerHTML += words[index] + ' ';
                    index++;
                    setTimeout(displayNextWord, 5); // Adjust the delay (in milliseconds) as needed
                } else {
                    currentTextElement.removeAttribute('id');
                }
            }
            displayNextWord();
        }

        function showLoading(show) {
		    const loadingDiv = document.getElementById('loading');
		    const submitButton = document.getElementById('submit-button');
		    loadingDiv.style.display = show ? 'block' : 'none';
		    submitButton.disabled = show;
		}

        window.onload = function() {
            document.getElementById('menu').classList.remove('hidden');
        }
    </script>
</body>
</html>
